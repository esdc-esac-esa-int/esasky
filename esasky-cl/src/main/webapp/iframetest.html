
<html>

<head>
	<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
</head>

<body>



<script>



function gotoRaDec(){
	document.getElementById('myiframe').contentWindow.postMessage( {event: 'goToRaDec', content:{ra: $("#ra").val(), dec: $("#dec").val()}}, 'http://skyint.esac.esa.int');
}

function setFov(){
	document.getElementById('myiframe').contentWindow.postMessage({event: 'setFov', content:{fov: $("#fov").val()}}, 'http://skyint.esac.esa.int');
}


function goToTargetName(){
	document.getElementById('myiframe').contentWindow.postMessage({event: 'goToTargetName', content:{targetName: $("#targetname").val()}}, 'http://skyint.esac.esa.int');
}

function overlayCatalogue(){
	var t = JSON.parse($("#catalogue").val());
	document.getElementById('myiframe').contentWindow.postMessage({event:'overlayCatalogue', content: t}, 'http://skyint.esac.esa.int');
	document.getElementById('myiframe').contentWindow.postMessage({event: 'goToRaDec', content:{ra: t.overlaySet.skyObjectList[0].ra, dec: t.overlaySet.skyObjectList[0].dec}}, 'http://skyint.esac.esa.int');
}

function overlayCatalogueWithDetails(){
	var t = JSON.parse($("#catalogueWithDetails").val());
	document.getElementById('myiframe').contentWindow.postMessage({event:'overlayCatalogueWithDetails', content: t}, 'http://skyint.esac.esa.int');
}


function changeHipsWithParams(){
   document.getElementById('myiframe').contentWindow.postMessage(
   {
      event:'changeHipsWithParams', 
      content: 
         {
            'hips': 
               {
                  'name': $("#hipsName").val(), 
                  'id': $("#hipsName").val(), 
                  'url': $("#hipsURL").val(), 
                  'cooframe': $("#hipsCooFrame").val(), 
                  'maxnorder': $("#hipsNorder").val(), 
                  'imgformat': $("#hipsImgFormat").val()
               }
         }
      }
   , 'http://skyint.esac.esa.int');

}

function showGrid(isenabled){
   document.getElementById('myiframe').contentWindow.postMessage(
   {
      event:'showCoordinateGrid', 
      content:{show:isenabled}
   }
   , 'http://skyint.esac.esa.int');
}

function callExternalTap() {
   
   document.getElementById('myiframe').contentWindow.postMessage(
      {
         event:'newExtTapService', 
         content:{
            name: $("#esaskyName").val(), 
            tapUrl: $("#tapURL").val(), 
            tapTable: $("#tapTable").val(), 
            adql: $("#tapADQL").val()}
      }
      , 'http://skyint.esac.esa.int');
}

</script>


<div style="width:100%;">


   <div style="float:left; width:65%;">
      <iframe name='myiframe' id='myiframe' width='100%' height='100%' src="http://skyint.esac.esa.int"></iframe>
   </div>

   <div style="width:33%; height: 768px; overflow:scroll; float:left;">

      <div style='border: solid 1px; width: 90%; padding: 10px; float: left;'>
         Values can be either in degrees or in sexagesimal format (hh mm ss +/-dd mm ss)
         <br/>
         RA: <input id="ra" type="text" value="01 36 41"/>
         &nbsp;&nbsp;&nbsp;
         Dec: <input id="dec" type="text" value="+15 47 00"/>
         <br/>
         <button type="button" onclick="gotoRaDec();">Go to RA and Dec</button>
      </div>
      <div style='border: solid 1px; width: 90%; padding: 10px;'>
         Target name: <input id="targetname" type="text" value="kepler snr"/>
         &nbsp;&nbsp;&nbsp;
         <button type="button" onclick="goToTargetName();">Go to target by name</button>
      </div>
      

      <div style='border: solid 1px; width: 90%; padding: 10px;'>
            ESASky HiPS name
            HiPS name: <input id="hipsName" type="text" value="Chandra" size=35/>
            <br/>
            HiPS URL: <input id="hipsURL" type="text" value="https://cdaftp.cfa.harvard.edu/cxc-hips/" />
            <br/>
            cooframe: <input id="hipsCooFrame" type="text" value="J2000" />
            <br/>
            max norder: <input id="hipsNorder" type="text" value="11" />
            <br/>
            image format: <input id="hipsImgFormat" type="text" value="png" />
            <br/>
            <button type="button" onclick="changeHipsWithParams();">Switch HiPS to </button>
         </div>

         <div style='border: solid 1px; width: 90%; padding: 10px;'>
               FoV in decimal degrees
               FoV: <input id="fov" type="text" value="0.15"/>
               &nbsp;&nbsp;&nbsp;
               <button type="button" onclick="setFov();">Change filed of view</button>
            </div>

      <div style='border: solid 1px; width: 90%; padding: 10px;'>
         JSON catalogue representation with details associated (it opens up ESASky data panel with the details written into the data section of each source):<br/> 
         <textarea id="catalogueWithDetails" rows="20" cols="50">
      {
         "overlaySet":{
            "type":"SourceListOverlay",
            "overlayName":"cat X",
            "cooframe":"equatorial",
            "color":"#ee2345",
            "lineWidth":10,
            "skyObjectList":[
               {
                  "name":"source A",
                  "id":1,
                  "ra":"105.69239256",
                  "dec":"-8.45235969",
                  "data":[
                     {
                        "name":"flux1",
                        "value":"11.5",
                        "type":"STRING"
                     },
                     {
                        "name":"flux2",
                        "value":"2.7",
                        "type":"STRING"
                     }
                  ]
               },{
                  "name":"source B",
                  "id":2,
                  "ra":"105.70779763",
                  "dec":"-8.31350997",
                  "data":[
                     {
                        "name":"flux1",
                        "value":"12.5",
                        "type":"STRING"
                     },
                     {
                        "name":"flux2",
                        "value":"1.7",
                        "type":"STRING"
                     }
                  ]
               },{
                  "name":"source C",
                  "id":3,
                  "ra":"105.74242906",
                  "dec":"-8.34776709",
                  "data":[
                     {
                        "name":"flux1",
                        "value":"10.5",
                        "type":"STRING"
                     },
                     {
                        "name":"flux2",
                        "value":"3.7",
                        "type":"STRING"
                     }
                  ]
               }

            ]
         }
      }
         </textarea>
         <br/>
         <button type="button" onclick="overlayCatalogueWithDetails();">Overlay catalogue</button>
         
      </div>

      


      <div style='border: solid 1px; width: 90%; padding: 10px;'>
         <button type="button" onclick="showGrid(true);">Show coordinates grid</button> &nbsp;&nbsp;&nbsp;
         <button type="button" onclick="showGrid(false);">Hide coordinates grid</button>
      </div>


      <div style='border: solid 1px; width: 90%; padding: 10px;'>
            Target name: <input id="targetname" type="text" value="sgr a"/>
            &nbsp;&nbsp;&nbsp;
            <button type="button" onclick="goToTargetName();">Go to target by name</button>
         </div>



      <div style='border: solid 1px; width: 90%; padding: 10px;'>
         External TAP (ObsCore) details
         sync URL: <input id="tapURL" type="text" size="40" value="http://archive.eso.org/tap_obs/sync"/>
         <br/>
         table: <input id="tapTable" type="text" value="ivoa.ObsCore" />
         <br/>
         ESASky display name: <input id="esaskyName" type="text" value="ESO test" />
         <br/>
         <textarea id="tapADQL" rows="20" cols="50">select top 2 * where obs_id > 10000 and dataproduct_type = 'IMAGE'
         </textarea>
         <br/>
         <button type="button" onclick="callExternalTap();">Retrieve metadata</button>
      </div>

   </div>
</div>
</body>
</html>


